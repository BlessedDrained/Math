# Что такое штрихкод?
Штрихкоды — это графическое представление данных с помощью последовательности штрихов и пробелов, которые могут быть считаны специальными устройствами (сканерами). Они используются для автоматической идентификации объектов, маркировки товаров, а также для хранения различной информации.
# Типы штрихкодов
## Одномерный
### Что из себя представляют одномерные штрихкоды?
Штрихкоды такого типа кодируют информацию по одной горизонтальной линии с помощью чередующихся белых и черных полос, имеющих разную ширину.
### Какие форматы существуют?
Например, Code128, PDF417.
### Особенности
- Данные кодируются по горизонтальной линии
- Большинстве форматов не имеют возможности коррекции ошибок. Таковыми являются, например, Code128, UPC
## Двумерный
### Что из себя представляют двумерные штрихкоды?
Штрихкоды такого типа кодируют информацию по горизонтали и вертикали, в отличие от одномерных.
### Какие форматы существуют?
Например, QR-code, Aztec, DataMatrix.
### Особенности
- Данные кодируются по горизонтали и вертикали
- Есть возможность коррекции ошибок. Например, для таких штрихкодов, как QR, DataMatrix, Aztec используются коды Рида-Соломона для этой цели.
# Генерация штрихкодов
## Используемые технологии
В качестве примера в рамках данной работы будут приведены примеры генерации одномерного Code128 и двумерного QR кодов. Все манипуляции будут происходить в веб-приложении, работающем на базе ASP.NET Core и использующем непосредственно для генерации библиотеку ZXing.Net.
Для QR будет продемонстрирован пример генерации с использованием коррекции ошибок на высоком уровне (допускается <= 30% потерь)
## Код для генерации
Непосредственно контроллер, обрабатывающий запросы на генерацию, выглядит следующим образом:
```csharp
var codeByteList = input.CodeType switch  
{  
    CodeType.Qr => _qrCodeWriter.Write(input.Input),  
    CodeType.Barcode => _barcodeWriter.Write(input.Input),  
    _ => throw new ArgumentOutOfRangeException()  
};  
  
// Создание стрима для записи  
var ms = new MemoryStream();  
  
// Запись бинарных данных PNG-изображения в стрим  
codeByteList.Save(ms, ImageFormat.Png);  
  
// В процессе записи стрима указатель на позицию будет сдвинут на записанное количество байт. // Если вернуть стрим в таком состоянии, то произойдет ошибка - из стрима в процессе обработки ответа будет прочитано меньше байт, чем фактически отправлено  
// Таким образом, нужно сдвинуть позицию на начальную - 0.  
ms.Seek(0, SeekOrigin.Begin);  
  
// Выше было задано, что изображение будет возвращено в формате PNG. Указываем соответствующий content-type  
return File(ms, MediaTypeNames.Image.Png);
```
## Генерация Code128
Для примера закодируем ссылку на сайт УрФУ. Выполняем запрос к веб-приложению:
```bash
curl -X 'POST' \
  'http://localhost:5297/barcode' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
  "input": "https://urfu.ru/ru/",
  "codeType": 2
}'
```
В результате получаем изображение следующего вида:
![[Code128.png]]

## Генерация QR
Для примера также будем кодировать ссылку на сайт УрФУ. Выполняем запрос к веб-приложению:
```bash
curl -X 'POST' \
  'http://localhost:5297/barcode' \
  -H 'accept: */*' \
  -H 'Content-Type: application/json' \
  -d '{
  "input": "https://urfu.ru/ru/",
  "codeType": 1
}'
```
Получаем изображение следующего вида:
![[QR.png]]